---
title: "Prob 3, CP1 - Agrupamento com 2 dimensões"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, echo=FALSE, warning=FALSE}
library(tidyverse, warn.conflicts = F)
library(rvest)
library(plotly)
library(cluster)
library(ggdendro)
theme_set(theme_light())
source("plota_solucoes_hclust.R")
```


## Filmes de Johnny Depp

Johnny Depp, ou John Christopher Depp II, é um dos maiores astros do cinema dos últimos tempos. Um dos melhores atores em atividade, o versátil Depp tem como característica trazer traços marcantes de sua personalidade para os seus personagens.


```{r message=FALSE, echo=FALSE, warning=FALSE}
from_page <- read_html("https://www.rottentomatoes.com/celebrity/johnny_depp") %>% 
    html_node("#filmographyTbl") %>% # A sintaxe da expressão é de um seletor à lá JQuery: https://rdrr.io/cran/rvest/man/html_nodes.html 
    html_table(fill=TRUE) %>% # Faz parse
    as.tibble()

filmes = from_page %>% 
    filter(RATING != "No Score Yet", 
           `BOX OFFICE` != "—", 
           CREDIT != "Executive Producer") %>%
    mutate(RATING = as.numeric(gsub("%", "", RATING)), 
           `BOX OFFICE` = as.numeric(gsub("[$|M]", "", `BOX OFFICE`))) %>% 
    filter(`BOX OFFICE` != 'NA')
```

## Descrevendo as variáveis

### Classificação dos Filmes

No gráfico abaixo temos uma visão da classificação dos filmes de Johnny Depp, segundo os dados do Rotten Tomatoes: 

```{r fig.width=4, fig.height=2, message=FALSE, echo=FALSE, warning=FALSE}
p = filmes %>% 
    ggplot(aes(x = RATING)) + 
    geom_histogram(aes(text = paste("Filme:", TITLE, "<br>", "Classificação:", RATING)),
                   bins = 16) + 
    scale_x_continuous(breaks=seq(0, 100, 10))+
    labs(title = "Frequência da Classificação dos Filmes de Johnny Depp", 
         x = "Classificação", 
         y = "Frequência")

ggplotly(p, tooltip = "text")
```

Tendo em vista apenas a classificação... 

### Bilheteria dos Filmes

Para a renda dos filmes, observar uma escala linear ou logarítmica levam a conclusões diferentes.

```{r fig.width=4, fig.height=2, message=FALSE, echo=FALSE, warning=FALSE}
p_box_office = filmes %>% 
    ggplot(aes(x = `BOX OFFICE`)) + 
    geom_histogram(aes(text = paste("Filme:", TITLE, "<br>", "Bilheteria:", `BOX OFFICE`)),
                   bins = 20) + 
    labs(title = "Frequência de Billheteria dos Filmes de Johnny Depp", 
         x = "Bilheteria", 
         y = "Frequência")

ggplotly(p_box_office, tooltip = "text")

p_box_office_log = p_box_office + scale_x_log10()

ggplotly(p_box_office_log, tooltip = "text")
```

### Duas dimensões

```{r fig.width=4, fig.height=2, message=FALSE, echo=FALSE, warning=FALSE}
p_duas_dimensoes = filmes %>% 
    ggplot(aes(x = RATING, y = `BOX OFFICE`, label = TITLE)) + 
    geom_point(aes(text = paste("Filme: ", TITLE, 
                                "<br>", "Classificação: ", RATING, 
                                "<br>", "Bilheteria: ", `BOX OFFICE`))) +
    labs(title = "Duas dimensões", 
         x = "Classificação", 
         y = "Bilheteria")

ggplotly(p_duas_dimensoes, tooltip = "text")
```


